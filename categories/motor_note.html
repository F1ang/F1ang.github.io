<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="一、直流无刷电机、现代永磁同步电机学习笔记  一、直流无刷电机、现代永磁同步电机学习笔记1.1、直流有刷电机(DC)     H桥(三极管)、电压、电流电路-运放     编码器及定时器溢出，PID(控制周期)-香农采样(采样f&#x3D;2信号f)、实际值突变能力，冒泡排序，一阶低通滤波(滤波系数0~1)。     1ms进行脉冲读取-&gt;5ms进行脉冲变化(速度)-&gt;2(10ms)进行速度滤波">
<meta property="og:type" content="website">
<meta property="og:title" content="斑点鹰不想熬夜">
<meta property="og:url" content="http://example.com/categories/motor_note.html">
<meta property="og:site_name" content="斑点鹰不想熬夜">
<meta property="og:description" content="一、直流无刷电机、现代永磁同步电机学习笔记  一、直流无刷电机、现代永磁同步电机学习笔记1.1、直流有刷电机(DC)     H桥(三极管)、电压、电流电路-运放     编码器及定时器溢出，PID(控制周期)-香农采样(采样f&#x3D;2信号f)、实际值突变能力，冒泡排序，一阶低通滤波(滤波系数0~1)。     1ms进行脉冲读取-&gt;5ms进行脉冲变化(速度)-&gt;2(10ms)进行速度滤波">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-02-11T15:26:42.344Z">
<meta property="article:modified_time" content="2026-02-11T15:26:42.344Z">
<meta property="article:author" content="By Spotted Owl">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/categories/motor_note">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title> | 斑点鹰不想熬夜
</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">斑点鹰不想熬夜</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content page posts-expand">
            

    
    
    
    <div class="post-block" lang="zh-CN">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">
</h1>

<div class="post-meta">
  

</div>

</header>

      
      
      
      <div class="post-body">
          <p><a href="#section1-foc">一、直流无刷电机、现代永磁同步电机学习笔记</a></p>
<p><span id="section1-foc"></span></p>
<h4 id="一、直流无刷电机、现代永磁同步电机学习笔记"><a href="#一、直流无刷电机、现代永磁同步电机学习笔记" class="headerlink" title="一、直流无刷电机、现代永磁同步电机学习笔记"></a>一、直流无刷电机、现代永磁同步电机学习笔记</h4><pre><code>1.1、直流有刷电机(DC)
    H桥(三极管)、电压、电流电路-运放
    编码器及定时器溢出，PID(控制周期)-香农采样(采样f=2信号f)、实际值突变能力，冒泡排序，一阶低通滤波(滤波系数0~1)。
    1ms进行脉冲读取-&gt;5ms进行脉冲变化(速度)-&gt;2(10ms)进行速度滤波：冒泡+一阶低通滤波-&gt;50ms进行PID控制。
    速度环、电流环、角度环控制。  PID结果后进行一阶低通滤波pwm。
    舵机20ms的PWM，脉宽0.5~2.5ms，0~180。  注：控制电平要和实际硬件电路联系起来，选择合适的PWM模式
    PWM2(信号反向)
    
1.2、步进电机
    位置-脉冲个数，转速-脉冲频率。
    细分驱动(电流)，DIR+EN+SPEED。
    PWM-ARR改变频率，翻转模式-CCR改变频率。
    角度-&gt;脉冲数-&gt;CC中断改变脉冲数(2次进入中断一个脉冲)。
    梯形加减速：频率加-均匀-减。周期T的计算-&gt;加速与减速的步数  速度和步数-&gt;运动阶段  步数=脉冲数。
    S型加减速：加加速阶段步数-减加速阶段步数-确认下一个脉冲周期。
    直线插补：至少2步进-多运动轴，分配驱动脉冲。  X+Y合成。 偏差。
    曲线插补：X-Y分布走。
    闭环系统：编码器
    步进:脉冲数+脉冲频率(脉冲时间间隔=c/f)，步数+加减速度， 定时器计数-第n个脉冲-加减速与平稳， 加减速-步数-脉冲-每一步时间间隔，  手段-&gt;定时器CCR
    加速度=c0步进延时--下一个脉冲比较值， 状态机-步数，  输出翻转-&gt;中断变更CCR,步进数  设置-&gt;执行
    
    //-----------------------------步进电机-----------------------------//
    基础篇:
        1、相数正比步距角(1步进脉冲转的角度)、拍数(电周期)四相四拍(AB-BC-CD-DA-AB)、定位转矩(无电自锁力)、保持转矩(通电无转自锁力)
        步距角精度、失步(避免高速失步-&gt;加减速曲线)、矩频特性曲线
        
        2、角位移与输入的脉冲数成正比、转速与脉冲频率成正比,改变绕组通电的顺序， 电机就会反转。
        
        3、单极性整步驱动A-B-C-D  单极性半步驱动A-AB-B-BC-C-CD-D-DA 
        双极性整步驱动CA-DB-AC-BD 双极性半步驱动CA－&gt;CA/DB－&gt;DB－&gt;DB/AC－&gt;AC－&gt;AC/BD－&gt;BD－&gt;BD/CA
        细分驱动Ia与Ib合成旋转磁场,拖动转子.

        4、硬件配置:开漏ENA与DIR，PUL为OC输出、T=2*toggle_pulse
        脉冲不同频率输出-&gt;脉冲数-&gt;步进角
        细分数(旋转一周需要的脉冲数)
        多电机=多轴数

        5、空载启动频率(大于会失步或者啸叫)
        软件配置: 脉冲频率 = (60 RPM × 200 整步 × 16 细分) / 60 秒=3200 Hz

    进阶篇:
        综述,高速必须用曲线加速算法起动:分级加速、梯形加速、S字加速
        1、梯形加减速:丢步与过冲

1.3、直流无刷电机
    方波驱动-BLDC，正弦波-PMSM。
    六步换相：UVW-&gt;PWM调制-&gt;位置检测。
    电角度=机械角度*极对数。
    有感BLDC-逆变电路、PWM上桥臂、HALL及真值表。
    函数指针的使用。  RPM-圈/min。
    双环控制：电流环+转速环。  有感UVW-HUVW
    无感驱动：UVW，反电动势过零点检测与换相(延迟30°导通换相)，运放比较器与中性点电路设计。  比较器信号-&gt;HALL信号。
    开环加速-&gt;闭环换相。磁极对数-&gt;电角度-&gt;比较器的脉冲(电流)频率。
    无刷直流电机无感控制：速度闭环、速度+电流双闭环。   电流环-&gt;主要针对有负载。
    SPWM:面积等效(方波-&gt;正弦波  等幅不等宽)-傅里叶级数   正弦波-&gt;由方波w等,调宽(占空比)级数叠加  占空比=1/T  T=1/f
    SVPWM:平均值等效原理

1.4、FOC控制算法
    UVW三相同时导通，常用永磁直流无刷电机(PMSM)-反电动势-正弦波。 SVPWM合成电压空间矢量。(SPWM仅是针对单相)磁场矢量控制方法。  
    1、死区-上下管，COM事件-6步-接口定时器(HALL)-TRGI，BEMF=U-压降，接口定时器(计数CNT-捕获、主从、延时动作CCR2-PWM2)-控制定时器-主从及复位-TRGO(换向)，HALL也可以EXTI。
    2、SPWM:调制波(输入信号)、载波(频谱信号)-周期与幅值  (U/I)跟踪控制-&gt;滞环环节  中心对齐-CNT作为载波-CCR阈值界(类调制波-脉宽)  
        载波比恒定:1正弦周期内的脉冲数恒定--&gt;查表法调制SPWM  底部采样  同步调制--f同步
    3、FOC:PMSM-正弦反电动势，n3!组合开关-&gt;空间电压矢量-&gt;旋转电压-&gt;电源角频率,  开关次数-7段/5段,  ap空间坐标系  扇区-&gt;矢量T-&gt;三相CCR
        调制波(隐含)-相电压/线电压函数-马鞍/正弦
        坐标变换-解耦, 本质:FOC就是把定子电流分解为与转子磁链同相的直轴分量及正交的交轴分量.  Clark:标幺量(U1/Un常用百分数表示)
        位置与转速:HALL、光电、ABZ位置传感器,  电流滑动控制器SMC--观测器--位置和速度,  反电动势-&gt;角度    滤波--需补偿  
        电流矢量控制--最大转矩电流比控制、id*=0控制、弱磁控制(弱反电动势、提速)、cosφ=1控制
        本质:空间位置对力矩的控制   调节磁场-&gt;磁力-&gt;转矩-&gt;转速  T=转子磁场*定子磁场  弱磁控制-恒转矩-恒功率-正弦电流频率
    
        无感PMSM:位置检测算法-Observer+PLL(BEMF)、高频注入算法(IPMSM)。
        TIM1-&gt;ADC采样点(P471)---SVPWM调制指数(导通时间反比)、死区时间、噪声时间、采样转换时间
        IPMSM-内嵌式永磁同步电机-MTPA(IPMSM的最大转矩电流比)=iq/id
        PID参数自整定，  !!!SVPWM信号&lt;-&gt;BEMF与HALL信号，!!!  周期测量频率1:1000   霍尔信号频率-采样(分辨率)-定时器计数(预分频)
        电频率=磁极对数 x 机械频率  
        霍尔传感器信号捕获中断服务函数：转子旋转方向确定、 计算电角度、计算新的预分频器值、 更新速度周期 FIFO 缓冲区、 转子电频率计算

        BLDC:集中绕组,BEMF-梯形波,CTR-方波(直流-逆变-交流),直流电机,6步
        PMSM:分布短距绕组,BEMF-正弦波,CTR-三相正弦波(交流),同步电机,FOC

        FOC（Filed Oriented Control）是采用数学方法实现三相马达的力矩与励磁的解耦控制。主要是对电机的控制电流进行矢量分解，变成励磁电流Id和交轴电流Iq,励磁电流主要是产生励磁,控制的是磁场的强度,而交轴电流是用来控制力矩
        FOC（电机矢量控制）要求严格的转子磁场定向，对于BLDC电机而言转子磁场方向始终与转子位置一致，因此其控制输入需要准确的转子绝对位置信号
        
        DTC（直接转矩控制）实际上与基于定子磁场定向，而定子磁场则是依据电压积分估算获得，在这个过程中跟转子位置没有关系，其控制过程中用到的量也都是静止坐标系下的量，
        因此DTC控制相比于FOC控制要简单很多，完全不需要求解三角函数、坐标变换，如果需要用DTC进行速度闭环则需要测量电机的速度，但是依然不需要准确的绝对位置。
        
        本质；矢量控制，它的基本思想就是一致的：将多变量、强耦合、非线性、时变的交流电机复杂矢量系统通过解耦（坐标变换）的方式等效成直流电机的简单标量系统。
        BLDC转矩波动-BENF顶部大于120°,不转矩波动(理论)- 梯形~=正弦 - FOC - 位置信息传感器
    4、编码器校准:0度相位-定子角度-编码器	预启动(转矩iq和磁通id校准/SVPWM)-加速-运行
    ST-FOC源码分析 2024.2.27

1.5、FOC算法关键量化变量
    1、有效非零矢量-作用时间-调制比   abc-&gt;ap坐标，引入方向(欧拉变换)  定方向，动大小(作用时间)  电压矢量增加角度  调制比=调制波基波峰值/载波基波峰值
    2、零矢量平均分配-PWM对称-降低PWM谐波分量   Ts代表载波周期，即开关周期  
    3、在三相正弦波中注入了零序分量的调制波进行规则采样的一种变形SPWM(调制波-正弦波)  SVPWM(正弦波+零序分量)
    4、坐标变换、 PID 算法、 SVPWM 技术和新变换角（变相角度）--电机转子位置和速度=&gt;有传感器/无传感器
    5、电机单相模型-&gt;Is-&gt;电流观测器-&gt;反电动势-&gt;位置    theta+w-&gt;滤波-&gt;延迟-&gt;相位补偿
    6、abc-&gt;ap坐标变换,引入方向(欧拉变换)    ap定方向,动大小(作用时间)--&gt;合成矢量反之  (ap-欧拉系)
    7、有效非零适量-作用时间-调制比(利用率=调制波幅值/载波幅值)  7段式SVPWM/5段式SVPWM  
    8、定子磁场-扭力 与转子力臂垂直    FOC建模-将转子磁通作为定子和气隙磁通的参考坐标系-力追踪转子位置  SVPWM-电压同步转子位置   励磁/转矩分量
    9、FOC关键:对电流矢量的幅值和空间位置(频率和相位)的控制    转子磁极位置-逆变器输出频率-转子角频率(异步-同步)  id-转速,iq-转矩(直流)  (定子坐标)电流空间矢量-&gt;dq(转子坐标)-&gt;反变换-&gt;FOC
    10、电机转矩正比于 转子磁场 叉积 定子磁场.   电流-磁场-力-转矩-速度  U=磁场的微分(dB/dS=U)  磁动势=有效匝数*电流   

    外面旋转磁场旋转 → 切割了鼠笼的金属导体 → 金属导体产生了电动势 → 由于鼠笼短接所以金属导体就产生了感应电流 → 感应电流产生了一个磁场（转子磁场）
</code></pre>

      </div>
      
      
      
    </div>
    

    
    
    


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%9B%B4%E6%B5%81%E6%97%A0%E5%88%B7%E7%94%B5%E6%9C%BA%E3%80%81%E7%8E%B0%E4%BB%A3%E6%B0%B8%E7%A3%81%E5%90%8C%E6%AD%A5%E7%94%B5%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="nav-number">1.</span> <span class="nav-text">一、直流无刷电机、现代永磁同步电机学习笔记</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="By Spotted Owl"
      src="/images/fyp.jpg">
  <p class="site-author-name" itemprop="name">By Spotted Owl</p>
  <div class="site-description" itemprop="description">少年自有凌云志，不负黄河万古流.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2025-10 – 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">By Spotted Owl</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
